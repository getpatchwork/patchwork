{% extends "base2.html" %}

{% block title %}Bundles{% endblock %}

{% block body %}
<div class="container" style="margin-top: 1rem;">
  <h1 class="title">
    Bundles
  </h1>

  <section class="block">
    <p>
      Bundles are groups of related patches.
      You can create bundles by selecting patches from a project,
      then using the 'create bundle' form to give your bundle a name.
      Each bundle can be public or private;
      public bundles are given a persistent URL,
      based on your username and the name of the bundle.
      Private bundles are only visible to you.
    </p>
  </section>

  <section class="block">
{% if bundles %}
    <div class="table-container">
      <table class="table is-fullwidth">
        <tr>
          <th class="has-text-left">Bundle</th>
          <th class="has-text-centered">Project</th>
          <th class="has-text-centered">Patches</th>
          <th class="has-text-centered">Public</th>
          <th class="has-text-right">Actions</th>
        </tr>
{% for bundle in bundles %}
        <form id="delete-bundle" method="post" onsubmit="return confirm_delete('bundle', '{{ bundle.name|escapejs }}');">
          {% csrf_token %}
          <input type="hidden" name="form_name" value="deletebundleform">
          <input type="hidden" name="bundle_id" value="{{ bundle.id }}">
        </form>
        <tr>
          <td class="has-text-left">
            <a href="{{ bundle.get_absolute_url }}">{{ bundle.name }}</a>
          </td>
          <td class="has-text-centered">
            <a href="{% url 'project-detail' project_id=bundle.project.linkname %}">
              {{ bundle.project.name }}
            </a>
          </td>
          <td class="has-text-centered">{{ bundle.patches.count }}</td>
          <td class="has-text-centered">
{% if bundle.public %}
            <span class="icon">
              <i class="fa fa-check"></i>
            </span>
{% else %}
            <span class="icon">
              <i class="fa fa-times"></i>
            </span>
{% endif %}
          </td>
          <td class="has-text-right">
            <a href="{{ bundle.get_mbox_url }}" class="button is-success is-small">
              <span class="icon is-small"><i class="fas fa-download"></i></span>
              <span>Download</span>
            </a>
            <button class="button is-danger is-small" form="delete-bundle">
              <span class="icon is-small"><i class="fas fa-times"></i></span>
              <span>Delete</span>
            </button>
          </td>
        </tr>
{% endfor %}
      </table>
    </div>
{% else %}
    <div class="box">
      <div class="columns">
        <div class="column is-narrow">
          <span class="icon">
            <i class="fa fa-info"></i>
          </span>
        </div>
        <div class="column">
          <p>You have no bundles.</p>
        </div>
      </div>
    </div>
{% endif %}
  </section>
</div>
{% endblock %}
